parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KIzB":[function(require,module,exports) {
"use strict";function e(e){return i(e)||r(e)||n(e)||t()}function t(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function r(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function i(e){if(Array.isArray(e))return l(e)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}var s=function(){function e(t){o(this,e),this.cells=m(t).map(function(e,t){return new a(e,t%4,Math.floor(t/4))})}return c(e,[{key:"randomEmptyCell",value:function(){var e=Math.floor(Math.random()*this.emptyCells.length);return this.emptyCells[e]}},{key:"emptyCells",get:function(){return this.cells.filter(function(e){return null===e.tile})}},{key:"cellsByColumn",get:function(){return this.cells.reduce(function(e,t){return e[t.x]=e[t.x]||[],e[t.x][t.y]=t,e},[])}},{key:"cellsByRow",get:function(){return this.cells.reduce(function(e,t){return e[t.y]=e[t.y]||[],e[t.y][t.x]=t,e},[])}}]),e}(),a=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;o(this,e),this.cellElement=t,this.x=n,this.y=r,this.tile=i,this.mergeTile=l}return c(e,[{key:"canAccept",value:function(e){return null===this.tile||null===this.mergeTile&&this.tile.value===e.value}},{key:"mergeTiles",value:function(){if(null!==this.tile&&null!==this.mergeTile){var e=this.tile.value+this.mergeTile.value,t=w+e;w=t,C.textContent=t,x(e),this.tile.value=this.tile.value+this.mergeTile.value,this.mergeTile.remove(),this.mergeTile=null;var n=this.tile.value;2048===this.tile.value&&(p.classList.remove("hidden"),E=!0),this.tile.tileElement.classList.remove("field-tile--".concat(n/2)),this.tile.tileElement.classList.add("field-tile--".concat(n)),this.tile.tileElement.textContent=n}}},{key:"tile",get:function(){return this._tile},set:function(e){this._tile=e,null!==e&&(this._tile.x=this.x,this._tile.y=this.y)}},{key:"mergeTile",get:function(){return this._mergeTile},set:function(e){this._mergeTile=e}}]),e}(),f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random()<.1?4:2;o(this,e),this.tileElement=document.createElement("div"),this.tileElement.classList.add("field-tile","field-tile--".concat(n)),t.append(this.tileElement),this.value=n}return c(e,[{key:"remove",value:function(){this.tileElement.remove()}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.tileElement.textContent=e}},{key:"x",set:function(e){this._x=e,this.tileElement.style.setProperty("left","".concat(85*e+10,"px"))}},{key:"y",set:function(e){this._y=e,this.tileElement.style.setProperty("top","".concat(85*e+10,"px"))}}]),e}();function m(e){for(var t=[],n=0;n<16;n++){var r=document.createElement("div");r.classList.add("field-cell"),t.push(r)}return t.forEach(function(t){e.appendChild(t)}),t}var h=document.querySelector(".game-field"),d=document.querySelector(".start"),y=document.querySelector(".message-start"),v=document.querySelector(".message-lose"),p=document.querySelector(".message-win"),g=new s(h),w=0,E=!1;d.addEventListener("click",k);var C=document.querySelector(".game-score");function k(){E=!1,d.classList.remove("start"),d.classList.add("restart"),d.textContent="restart",y.classList.add("hidden"),g.randomEmptyCell().tile=new f(h),g.randomEmptyCell().tile=new f(h),d.removeEventListener("click",k),d.addEventListener("click",T),A()}var b=[];function x(e){b.push(e),1===b.length&&L()}function L(){if(0!==b.length){var e=b[0],t=document.querySelector(".score-increase");t.textContent="+".concat(e),setTimeout(function(){t.textContent="",b.shift(),L()},300)}}function T(){document.querySelectorAll(".field-tile").forEach(function(e){return e.remove()}),h.innerHTML="",(g=new s(h)).randomEmptyCell().tile=new f(h),g.randomEmptyCell().tile=new f(h),w=0,E=!1,C.textContent=w,p.classList.add("hidden"),v.classList.add("hidden")}function A(){window.addEventListener("keydown",S)}function S(e){if(!E){switch(e.key){case"ArrowUp":if(!j())return void A();B();break;case"ArrowDown":if(!O())return void A();_();break;case"ArrowLeft":if(!I())return void A();q();break;case"ArrowRight":if(!P())return void A();M();break;default:return void A()}g.cells.forEach(function(e){return e.mergeTiles()});var t=new f(h);g.randomEmptyCell().tile=t,j()||O()||I()||P()||v.classList.remove("hidden"),A()}}function B(){return R(g.cellsByColumn)}function _(){return R(g.cellsByColumn.map(function(t){return e(t).reverse()}))}function q(){return R(g.cellsByRow)}function M(){return R(g.cellsByRow.map(function(t){return e(t).reverse()}))}function R(e){e.forEach(function(e){for(var t=1;t<e.length;t++){var n=e[t];if(null!==n.tile){for(var r=null,i=t-1;i>=0;i--){var l=e[i];if(!l.canAccept(n.tile))break;r=l}null!==r&&(null!==r.tile?r.mergeTile=n.tile:r.tile=n.tile,n.tile=null)}}})}function j(){return U(g.cellsByColumn)}function O(){return U(g.cellsByColumn.map(function(t){return e(t).reverse()}))}function I(){return U(g.cellsByRow)}function P(){return U(g.cellsByRow.map(function(t){return e(t).reverse()}))}function U(e){return e.some(function(e){return e.some(function(t,n){return 0!==n&&(null!==t.tile&&e[n-1].canAccept(t.tile))})})}
},{}]},{},["KIzB"], null)
//# sourceMappingURL=main.958bee2f.js.map